language: python

python:
  - "3.7"

cache: pip

branches:
  only:
    - master
    - dev

script:
  - pip install flake8
  - flake8 substra
  - pip install -e .[test]
  - python setup.py test
  - python bin/generate_cli_documentation.py --output-path references/cli.md.tmp
  - cmp --silent references/cli.md references/cli.md.tmp
  - pydocmd simple substra.sdk+ substra.sdk.Client+ > references/sdk.md.tmp
  - cmp --silent references/sdk.md references/sdk.md.tmp
